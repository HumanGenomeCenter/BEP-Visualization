<!DOCTYPE html>
<meta charset="utf-8">
<title>Streamgraph</title>
<style>

body {
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
  margin: auto;
  position: relative;
  width: 960px;
}

button {
  position: absolute;
  right: 10px;
  top: 10px;
}

</style>
<button onclick="transition()">Update</button>
<script src="./js/d3.min.js"></script>
<script>

var streamData = JSON.parse('[[{"x":0,"y":1},{"x":1,"y":1},{"x":2,"y":1},{"x":3,"y":1},{"x":4,"y":1},{"x":5,"y":1},{"x":6,"y":1},{"x":7,"y":1},{"x":8,"y":1},{"x":9,"y":1},{"x":10,"y":2},{"x":11,"y":2},{"x":12,"y":2},{"x":13,"y":2},{"x":14,"y":2},{"x":15,"y":2},{"x":16,"y":2},{"x":17,"y":2},{"x":18,"y":2},{"x":19,"y":2},{"x":20,"y":2},{"x":21,"y":2},{"x":22,"y":2},{"x":23,"y":2},{"x":24,"y":2},{"x":25,"y":3},{"x":26,"y":4},{"x":27,"y":4},{"x":28,"y":4},{"x":29,"y":4},{"x":30,"y":4},{"x":31,"y":5},{"x":32,"y":5},{"x":33,"y":6},{"x":34,"y":7},{"x":35,"y":7},{"x":36,"y":7},{"x":37,"y":9},{"x":38,"y":9},{"x":39,"y":10},{"x":40,"y":12},{"x":41,"y":13},{"x":42,"y":13},{"x":43,"y":14},{"x":44,"y":16},{"x":45,"y":17},{"x":46,"y":18},{"x":47,"y":18},{"x":48,"y":18},{"x":49,"y":19}],[{"x":0,"y":1},{"x":1,"y":1},{"x":2,"y":1},{"x":3,"y":1},{"x":4,"y":1},{"x":5,"y":1},{"x":6,"y":1},{"x":7,"y":1},{"x":8,"y":1},{"x":9,"y":1},{"x":10,"y":1},{"x":11,"y":1},{"x":12,"y":1},{"x":13,"y":1},{"x":14,"y":1},{"x":15,"y":1},{"x":16,"y":1},{"x":17,"y":1},{"x":18,"y":1},{"x":19,"y":1},{"x":20,"y":1},{"x":21,"y":1},{"x":22,"y":2},{"x":23,"y":2},{"x":24,"y":2},{"x":25,"y":2},{"x":26,"y":2},{"x":27,"y":2},{"x":28,"y":2},{"x":29,"y":2},{"x":30,"y":2},{"x":31,"y":2},{"x":32,"y":2},{"x":33,"y":2},{"x":34,"y":2},{"x":35,"y":2},{"x":36,"y":2},{"x":37,"y":2},{"x":38,"y":2},{"x":39,"y":2},{"x":40,"y":2},{"x":41,"y":2},{"x":42,"y":3},{"x":43,"y":3},{"x":44,"y":3},{"x":45,"y":3},{"x":46,"y":3},{"x":47,"y":4},{"x":48,"y":4},{"x":49,"y":4}],[{"x":0,"y":1},{"x":1,"y":1},{"x":2,"y":1},{"x":3,"y":1},{"x":4,"y":1},{"x":5,"y":1},{"x":6,"y":1},{"x":7,"y":1},{"x":8,"y":1},{"x":9,"y":1},{"x":10,"y":1},{"x":11,"y":1},{"x":12,"y":1},{"x":13,"y":1},{"x":14,"y":1},{"x":15,"y":1},{"x":16,"y":1},{"x":17,"y":1},{"x":18,"y":1},{"x":19,"y":1},{"x":20,"y":1},{"x":21,"y":1},{"x":22,"y":1},{"x":23,"y":1},{"x":24,"y":1},{"x":25,"y":1},{"x":26,"y":2},{"x":27,"y":2},{"x":28,"y":2},{"x":29,"y":2},{"x":30,"y":2},{"x":31,"y":2},{"x":32,"y":2},{"x":33,"y":2},{"x":34,"y":2},{"x":35,"y":2},{"x":36,"y":2},{"x":37,"y":2},{"x":38,"y":2},{"x":39,"y":2},{"x":40,"y":2},{"x":41,"y":4},{"x":42,"y":4},{"x":43,"y":4},{"x":44,"y":4},{"x":45,"y":4},{"x":46,"y":4},{"x":47,"y":4},{"x":48,"y":4},{"x":49,"y":4}],[{"x":0,"y":1},{"x":1,"y":1},{"x":2,"y":1},{"x":3,"y":1},{"x":4,"y":1},{"x":5,"y":1},{"x":6,"y":1},{"x":7,"y":1},{"x":8,"y":1},{"x":9,"y":1},{"x":10,"y":1},{"x":11,"y":1},{"x":12,"y":1},{"x":13,"y":1},{"x":14,"y":1},{"x":15,"y":1},{"x":16,"y":1},{"x":17,"y":1},{"x":18,"y":1},{"x":19,"y":1},{"x":20,"y":1},{"x":21,"y":1},{"x":22,"y":1},{"x":23,"y":1},{"x":24,"y":1},{"x":25,"y":1},{"x":26,"y":1},{"x":27,"y":1},{"x":28,"y":1},{"x":29,"y":1},{"x":30,"y":1},{"x":31,"y":1},{"x":32,"y":1},{"x":33,"y":1},{"x":34,"y":1},{"x":35,"y":1},{"x":36,"y":1},{"x":37,"y":1},{"x":38,"y":1},{"x":39,"y":1},{"x":40,"y":1},{"x":41,"y":1},{"x":42,"y":1},{"x":43,"y":1},{"x":44,"y":1},{"x":45,"y":1},{"x":46,"y":1},{"x":47,"y":1},{"x":48,"y":1},{"x":49,"y":1}],[{"x":0,"y":1},{"x":1,"y":1},{"x":2,"y":1},{"x":3,"y":1},{"x":4,"y":1},{"x":5,"y":1},{"x":6,"y":1},{"x":7,"y":1},{"x":8,"y":1},{"x":9,"y":1},{"x":10,"y":2},{"x":11,"y":2},{"x":12,"y":2},{"x":13,"y":2},{"x":14,"y":2},{"x":15,"y":2},{"x":16,"y":2},{"x":17,"y":2},{"x":18,"y":2},{"x":19,"y":2},{"x":20,"y":2},{"x":21,"y":2},{"x":22,"y":3},{"x":23,"y":3},{"x":24,"y":4},{"x":25,"y":4},{"x":26,"y":4},{"x":27,"y":4},{"x":28,"y":4},{"x":29,"y":4},{"x":30,"y":4},{"x":31,"y":5},{"x":32,"y":5},{"x":33,"y":6},{"x":34,"y":6},{"x":35,"y":6},{"x":36,"y":6},{"x":37,"y":6},{"x":38,"y":7},{"x":39,"y":7},{"x":40,"y":7},{"x":41,"y":7},{"x":42,"y":7},{"x":43,"y":7},{"x":44,"y":7},{"x":45,"y":7},{"x":46,"y":7},{"x":47,"y":7},{"x":48,"y":7},{"x":49,"y":7}],[{"x":0,"y":1},{"x":1,"y":1},{"x":2,"y":1},{"x":3,"y":1},{"x":4,"y":1},{"x":5,"y":1},{"x":6,"y":1},{"x":7,"y":1},{"x":8,"y":1},{"x":9,"y":1},{"x":10,"y":1},{"x":11,"y":1},{"x":12,"y":1},{"x":13,"y":1},{"x":14,"y":2},{"x":15,"y":2},{"x":16,"y":2},{"x":17,"y":2},{"x":18,"y":2},{"x":19,"y":2},{"x":20,"y":2},{"x":21,"y":2},{"x":22,"y":2},{"x":23,"y":2},{"x":24,"y":2},{"x":25,"y":2},{"x":26,"y":2},{"x":27,"y":2},{"x":28,"y":2},{"x":29,"y":2},{"x":30,"y":2},{"x":31,"y":2},{"x":32,"y":3},{"x":33,"y":3},{"x":34,"y":3},{"x":35,"y":3},{"x":36,"y":3},{"x":37,"y":3},{"x":38,"y":3},{"x":39,"y":3},{"x":40,"y":3},{"x":41,"y":3},{"x":42,"y":3},{"x":43,"y":4},{"x":44,"y":4},{"x":45,"y":4},{"x":46,"y":5},{"x":47,"y":5},{"x":48,"y":5},{"x":49,"y":5}]]');

var n = 6, // number of layers
    m = 50, // number of samples per layer
    stack = d3.layout.stack().offset("silhouette"),
    layers0 = stack(d3.range(n).map(function() { return bumpLayer(m); })),
  //  layers1 = stack(d3.range(n).map(function() { return bumpLayer(m); })),
	layers1 = stack(streamData);

var width = 600,
    height = 200;

var x = d3.scale.linear()
    .domain([0, m - 1])
    .range([0, width]);

var y = d3.scale.linear()
    // .domain([0, d3.max(layers0.concat(layers1), function(layer) { return d3.max(layer, function(d) { return d.y0 + d.y; }); })])
    .domain([0, d3.max(layers1, function(layer) { return d3.max(layer, function(d) { return d.y0 + d.y; }); })])

	//.domain([0, 200])
    .range([height, 0]);

var color = d3.scale.linear()
    .range(["#aad", "#556"]);

var area = d3.svg.area()
    .x(function(d) { return x(d.x); })
    .y0(function(d) { return y(d.y0); })
    .y1(function(d) { return y(d.y0 + d.y); });

var svg = d3.select("body").append("svg")
    .attr("width", width)
    .attr("height", height);

svg.selectAll("path")
    .data(layers0)
  .enter().append("path")
    .attr("d", area)
    .style("fill", function(d, i) { 
	console.log(i);
		return color(Math.random()); 
		});

function transition() {
  d3.selectAll("path")
      .data(function() {		// update data
        var d = layers1;
        layers1 = layers0;
        return layers0 = d;
      })
    .transition()
      .duration(2500)
      .attr("d", area);			// transition area.... (check svg)
}

function bump(a, n) {
  var x = 1 / (.1 + Math.random()),
      y = 2 * Math.random() - .5,
      z = 10 / (.1 + Math.random());
  for (var i = 0; i < n; i++) {
    var w = (i / n - y) * z;
    a[i] += x * Math.exp(-w * w);
  }
}

// Inspired by Lee Byron's test data generator.
function bumpLayer(n) {

  var a = [], i;
//  for (i = 0; i < n; ++i) a[i] = 0; // reset to 0
	
	for (i = 0; i < n; ++i) a[i] = i  + (i*Math.random()*20); // reset to 0

 // for (i = 0; i < 5; ++i) bump(a, n);


//	console.log(a);
	

  return a.map(function(d, i) { return {x: i, y: Math.max(0, d)}; });

}

</script>